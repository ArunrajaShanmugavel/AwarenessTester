<html>
	<head>
		<title>ColorMatch</title>
	</head>
	<style type="text/css">
		article
		{
			margin: 50px auto;
			width: 728px;
			text-align: center;
		}
		img{
			width: 150px;
		}
		label{
			font-family: "Helvetica";
			margin-right: 10px;
		}
		span{
			font-family: "sans-serif";
			font-weight: bold;
			font-size: 25px;
			width: 35px;
		}
	</style>
	<script type="text/javascript" src='../js/jquery-1.7.1.js'></script>
<body>
<article>
	<header>
		<h1>Color Match Game</h1>
	</header>
	<section>
		<div>
		<!--<div>
			<div><label>meaning:</label><span id='meaning'></span></div>
			<div><label>color:</label><span id='color'></span></div>
		</div>  -->
		<div align='center' >
			<table style='text-align:center;font-size:20px;width:40px' rules='ALL' frame='box' cellpadding='10px'>
				<thead><tr><td>meaning:</td><td  id='meaning' style='font-weight:bold'></td></tr>
				<tbody><tr><td>color:</td><td id='color' style='font-weight:bold'></td></tr>
			</table>
		</div>
		</div>
		
		<div style='padding:60px'>
			<b>How to Play:</b> 	Check for the match of <b><i>meaning</i></b> of 1st color with <b><i>actual color</i></b> of 2nd color?<br/><br/>

			<div align='center' style='margin-bottom:20px'>
				<table rules='ALL' frame='BOX' cellpadding = '5px'>
					<thead style='font:bold'><td>Meaning</td><td>Color</td><td>Match?</td></thead>
					<tr><td style='color:green'>Red</td><td style='color:red'>Blue</td><td>Match</td></tr>
					<tr><td style='color:green'>Red</td><td style='color:blue'>Blue</td><td>Not a Match</td></tr>
				</table>
			</div>

			Match = Press Right Arrow<br/>
			Not a Match = Press Left Arrow<br/><br/>
			Start playing to start the timer.
		</div>

		<div style='padding:0px'>
			Available Time is <span id='time'>60</span> seconds<br/>
			Score is <span id='score'>0</span><br/>
			Errors is <span id='error'>0</span>
		</div>

		<!-- Place this tag where you want the share button to render. -->
			<div class="g-plus" data-action="share"></div>

		<!-- Place this tag after the last share tag. -->
		<script type="text/javascript">
		  (function() {
		    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
		    po.src = 'https://apis.google.com/js/plusone.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
		  })();
		</script>

	</section>
	<section>
		
	</section>
</article>

<script type='text/javascript'>

var color=["green","blue","red","black","yellow"];
var isEqual;
var score=0;
var error=0;

pickOneColor=function(){
	return pickRandNumWithLimit(color.length-1);
}

pickRandNumWithLimit=function(limit){
	var rand_num = 0;
	do
		rand_num = Math.floor(Math.random()*10);
	while(rand_num>limit);

	// console.log("on create:rand_num is "+rand_num);
	return rand_num;
}

changeColor=function(){
	$('#color').text(color[pickOneColor()]);
	$('#meaning').css('color',color[pickOneColor()]);

	isEqual= (pickRandNumWithLimit(1)==0?false:true);

	// console.log('am in');
	if(isEqual){
		var rand_num = pickOneColor();
		// console.log("rand_num is "+rand_num);
		$('#meaning').text(color[rand_num]);
		$('#color').css('color',color[rand_num]);
	} else {
		$('#meaning').text(color[pickOneColor()]);
		$('#color').css('color',color[pickOneColor()]);
	}
}

firstFlag=true;
$(document).keydown(function(e){
	
	if((e.keyCode == 37 || e.keyCode == 39)){
	if(firstFlag)
	{
		startCounter(60);
		firstFlag=false;
	}
	if(!is_counter_on ){
		alert("Game Over. Refresh to play again !");
		return false;
	}
	}	
	
    if (e.keyCode == 37) { //left pressed
    	echo("left:score-"+score+",isEqual-"+isEqual);
        score = (!isEqual)?score+1:score;
        error=(isEqual)?error+1:error;
    }
    else if(e.keyCode == 39){  //right pressed
    	echo("right:score-"+score+",isEqual-"+isEqual);
		score = (isEqual)?score+1:score;
		error=(!isEqual)?error+1:error;
    }
    else
    	return true;

    echo(score);
    $('#score').text(score);
    $('#error').text(error);
    changeColor();
});

$(function(){
	changeColor();
});

echo=function(val){
	console.log(val);
};

// timer funcs

var timer_is_on=false ,c=0;

function startTimer()
{
if (!timer_is_on)
  {
	  timer_is_on=true;
	  secCount();
  }
}

var timer_id ;
function secCount()
{
	// document.getElementById('txt').value=c;
	$('#time').text(c);
	c=c+1;
	console.log("sec is "+c);
	if(c>60)
	{
		stopTimer();
		return false;
	}
	timer_id=setTimeout("secCount()",1000);
}

function stopTimer()
{
	console.log("stop timer");
	clearTimeout(timer_id);
	timer_is_on=false;
}

//counter funcs

var is_counter_on = false;

function startCounter(limit){
	if(!is_counter_on){
			is_counter_on = true;
			secCountForTimer(limit);
			e('counter is started');
		}
	else
		echo("counter is already running");
}

function secCountForTimer(c){
	if(c<1)
	{
		stopCounter();
		return false;
	}
	c=c-1;
	$('#time').text(c);
	console.log("sec is "+c);
	timer_id=setTimeout("secCountForTimer("+c+")",1000);
}

function stopCounter(){
	console.log("stop counter");
	clearTimeout(timer_id);
	is_counter_on=false;
}

</script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34150443-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>

</html>
